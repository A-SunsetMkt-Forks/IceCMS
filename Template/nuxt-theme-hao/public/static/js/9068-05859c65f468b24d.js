(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9068],{3940:(e,t,r)=>{"use strict";r.d(t,{A:()=>u});var n=r(81767),a=r(13647),s=r(90397),l=r(52118),i=r(84090);let o=function(e,t,r){let{get:n,useQuery:a}=(0,l.g)(),s=(0,i.E)(e);return a({queryKey:["websites:pageviews",{websiteId:e,...s,compare:t}],queryFn:()=>n("/websites/".concat(e,"/pageviews"),{...s,compare:t}),enabled:!!e,...r})};var c=r(93031);let u=function(e){let{websiteId:t,compareMode:r=!1}=e,{dateRange:l,dateCompare:i}=(0,c.Fi)(t),{startDate:u,endDate:d,unit:v,value:p}=l,{data:m,isLoading:h}=o(t,r?i:void 0),{pageviews:_,sessions:x,compare:b}=m||{},y=(0,a.useMemo)(()=>{if(m){let e={pageviews:_,sessions:x};return b&&(e.compare={pageviews:e.pageviews.map((e,t)=>{var r,n;let{x:a}=e;return{x:a,y:null==(r=b.pageviews[t])?void 0:r.y,d:null==(n=b.pageviews[t])?void 0:n.x}}),sessions:e.sessions.map((e,t)=>{var r,n;let{x:a}=e;return{x:a,y:null==(r=b.sessions[t])?void 0:r.y,d:null==(n=b.sessions[t])?void 0:n.x}})}),e}return{pageviews:[],sessions:[]}},[m,u,d,v]);return(0,n.jsx)(s.A,{data:y,minDate:u.toISOString(),maxDate:d.toISOString(),unit:v,isLoading:h,isAllTime:"all"===p})}},5968:e=>{e.exports={form:"PopupForm_form__jvnBM"}},21048:e=>{e.exports={menu:"FieldFilterEditForm_menu__Hhyaj",filter:"FieldFilterEditForm_filter__hUxwu",dropdown:"FieldFilterEditForm_dropdown__O2UkJ",text:"FieldFilterEditForm_text___BvdZ",selected:"FieldFilterEditForm_selected__0x1zP",search:"FieldFilterEditForm_search__TSQs2"}},29918:e=>{e.exports={menu:"FieldSelectForm_menu__Pk_bL",item:"FieldSelectForm_item___X66t",type:"FieldSelectForm_type__kaxaI"}},33582:(e,t,r)=>{"use strict";r.d(t,{A:()=>d});var n=r(81767),a=r(94118),s=r.n(a),l=r(4970),i=r.n(l),o=r(93031),c=r(46724),u=r.n(c);let d=function(e){let{href:t,className:r,variant:a,scroll:l=!0,children:c}=e,{dir:d}=(0,o.Ym)();return(0,n.jsx)(i(),{className:s()(u().button,r,{[u()[a]]:!0}),href:t,dir:d,scroll:l,children:c})}},34266:(e,t,r)=>{"use strict";r.d(t,{A:()=>d});var n=r(81767),a=r(13647),s=r(93031),l=r(634),i=r(75187),o=r(98780),c=r(21048),u=r.n(c);function d(e){let{websiteId:t,name:r,label:c,type:d,startDate:p,endDate:m,operator:h="eq",defaultValue:_="",onChange:x,allowFilterSelect:b=!0,isNew:y}=e,{formatMessage:j,labels:w}=(0,s.ot)(),[g,f]=(0,a.useState)(h),[k,F]=(0,a.useState)(_),[q,S]=(0,a.useState)(!1),L=(0,i.OM)(g),[A,C]=(0,a.useState)(""),[N,B]=(0,a.useState)(L?k:""),{filters:M}=(0,s.R7)(),{formatValue:P}=(0,s.tt)(),E=!g||L&&!N||!L&&!k,{data:W=[],isLoading:D,refetch:V}=(0,s.L4)({websiteId:t,type:r,startDate:p,endDate:m,search:A}),I=(0,a.useMemo)(()=>W.reduce((e,t)=>{let{value:n}=t;return e[n]=P(n,r),e},{}),[P,r,W]),Y=(0,a.useMemo)(()=>k?W.filter(e=>{var t,r;return null==(r=I[e])||null==(t=r.toLowerCase())?void 0:t.includes(k.toLowerCase())}):W,[k,I]);return(0,n.jsx)(o.lV,{children:(0,n.jsxs)(o.fh,{label:c,className:u().filter,children:[(0,n.jsxs)(o.LS,{gap:10,children:[b&&(0,n.jsx)(o.ms,{className:u().dropdown,items:["country","region","city"].includes(r)?M.filter(e=>e.type===d&&!e.label.match(/contain/gi)):M.filter(e=>e.type===d),value:g,renderValue:e=>{var t;return null==(t=M.find(t=>t.value===e))?void 0:t.label},onChange:e=>{f(e),[l.we.equals,l.we.notEquals].includes(e)?F(""):B("")},children:e=>{let{value:t,label:r}=e;return(0,n.jsx)(o.q7,{children:r},t)}}),N&&L&&(0,n.jsxs)("div",{className:u().selected,onClick:()=>{B(""),F(""),C(""),V()},children:[(0,n.jsx)(o.EY,{children:P(N,r)}),(0,n.jsx)(o.In,{children:(0,n.jsx)(o.FI.Close,{})})]}),!N&&L&&(0,n.jsxs)("div",{className:u().search,children:[(0,n.jsx)(o.Lw,{className:u().text,value:k,placeholder:j(w.enter),onChange:e=>F(e.target.value),onSearch:e=>{C(e)},delay:500,onFocus:()=>S(!0),onBlur:()=>{window.setTimeout(()=>S(!1),500)}}),q&&(0,n.jsx)(v,{values:Y,type:r,isLoading:D,onSelect:e=>{B(e),S(!1)}})]}),!N&&!L&&(0,n.jsx)(o.A_,{className:u().text,value:k,onChange:e=>F(e.target.value)})]}),(0,n.jsx)(o.$n,{variant:"primary",onClick:()=>{x({name:r,type:d,operator:g,value:L?N:k})},disabled:E,children:j(y?w.add:w.update)})]})})}let v=e=>{let{values:t,type:r,isLoading:a,onSelect:l}=e,{formatValue:i}=(0,s.tt)();return a?(0,n.jsx)(o.W1,{className:u().menu,variant:"popup",children:(0,n.jsx)(o.q7,{children:(0,n.jsx)(o.Rh,{icon:"dots",position:"center"})})}):(null==t?void 0:t.length)?(0,n.jsx)(o.W1,{className:u().menu,variant:"popup",onSelect:l,children:null==t?void 0:t.map(e=>{let{value:t}=e;return(0,n.jsx)(o.q7,{children:i(t,r)},t)})}):null}},36825:(e,t,r)=>{"use strict";r.d(t,{A:()=>d});var n=r(81767),a=r(98780),s=r(91258),l=r(86178),i=r(93031),o=r(634),c=r(46313),u=r.n(c);let d=function(e){let{websiteId:t,className:r,position:c="bottom",alignment:d="end",showText:v=!0}=e,{formatMessage:p,labels:m}=(0,i.ot)(),{renderUrl:h,router:_}=(0,i.cq)(),{fields:x}=(0,i.ti)(),{dateRange:{startDate:b,endDate:y}}=(0,i.Fi)(t),j=e=>{let{name:t,operator:r,value:n}=e,a=o.u$[r];_.push(h({[t]:a+n}))};return(0,n.jsxs)(a.J1,{className:r,children:[(0,n.jsxs)(a.$n,{className:u().button,variant:"quiet",children:[(0,n.jsx)(a.In,{children:(0,n.jsx)(a.FI.Plus,{})}),v&&(0,n.jsx)(a.EY,{children:p(m.filter)})]}),(0,n.jsx)(a.zD,{position:c,alignment:d,children:e=>(0,n.jsx)(s.A,{children:(0,n.jsx)(l.A,{websiteId:t,fields:x,startDate:b,endDate:y,onChange:t=>{j(t),e()}})})})]})}},46313:e=>{e.exports={button:"WebsiteFilterButton_button__OkGgI"}},46724:e=>{e.exports={button:"LinkButton_button__DKiNT",disabled:"LinkButton_disabled__rjGPc",primary:"LinkButton_primary__CzdZ_",secondary:"LinkButton_secondary__GSOCD",quiet:"LinkButton_quiet__gLZMf",danger:"LinkButton_danger__44YHG","size-sm":"LinkButton_size-sm__sSPH5","size-md":"LinkButton_size-md__dhGpk","size-lg":"LinkButton_size-lg__vvlht"}},61297:e=>{e.exports={container:"WebsiteMetricsBar_container__pm0Xq",actions:"WebsiteMetricsBar_actions__ldyrR",vs:"WebsiteMetricsBar_vs__wRWwG",dropdown:"WebsiteMetricsBar_dropdown__LvXpS",sticky:"WebsiteMetricsBar_sticky__gmj3l",isSticky:"WebsiteMetricsBar_isSticky__uBATt"}},62400:(e,t,r)=>{"use strict";r.d(t,{C:()=>l,V:()=>s});var n=r(54793),a=r(15962);function s(e){return+e>1e3?(0,a.NG)(+e):e}function l(e,t){return(r,a,s)=>{let l=new Date(s[a].value);switch(e){case"minute":return(0,n.Yq)(l,"h:mm",t);case"hour":return(0,n.Yq)(l,"p",t);case"day":return(0,n.Yq)(l,"PP",t).replace(/\W*20\d{2}\W*/,"");case"month":return(0,n.Yq)(l,"MMM",t);case"year":return(0,n.Yq)(l,"yyyy",t);default:return r}}}},63862:(e,t,r)=>{"use strict";r.d(t,{A:()=>f,h:()=>k});var n=r(81767),a=r(98780),s=r(94118),l=r.n(s),i=r(93031),o=r(19096),c=r(37916),u=r(73260),d=r(15962),v=r(52118),p=r(84090);let m=function(e,t,r){let{get:n,useQuery:a}=(0,v.g)(),s=(0,p.E)(e);return a({queryKey:["websites:stats",{websiteId:e,...s,compare:t}],queryFn:()=>n("/websites/".concat(e,"/stats"),{...s,compare:t}),enabled:!!e,...r})};var h=r(24093),_=r(36825),x=r(13647),b=r(96797),y=r(90655);function j(e){let{websiteId:t}=e,{formatMessage:r,labels:s}=(0,i.ot)(),[l,o]=(0,x.useState)(!1),c=(0,p.E)(t),u=(0,y.useSearchParams)(),{get:d}=(0,i.gf)(),v=async()=>{o(!0);let{zip:e}=await d("/websites/".concat(t,"/export"),{...c,...u}),r=atob(e),n=new Uint8Array(r.length);for(let e=0;e<r.length;e++)n[e]=r.charCodeAt(e);let a=new Blob([n],{type:"application/zip"}),s=URL.createObjectURL(a),l=document.createElement("a");l.href=s,l.download="download.zip",l.click(),URL.revokeObjectURL(s),o(!1)};return(0,n.jsx)(a.oS,{label:r(s.download),position:"top",children:(0,n.jsx)(a.Eg,{variant:"quiet",isLoading:l,onClick:v,children:(0,n.jsx)(a.In,{children:(0,n.jsx)(b.A.Download,{})})})})}var w=r(61297),g=r.n(w);function f(e){let{websiteId:t,sticky:r,showChange:s=!1,compareMode:v=!1,showFilter:p=!1}=e,{dateRange:x}=(0,i.Fi)(t),{formatMessage:b,labels:y}=(0,i.ot)(),w=(0,h.Ay)(e=>{var r;return null==(r=e[t])?void 0:r.dateCompare}),{ref:f,isSticky:k}=(0,i.xT)({enabled:r}),{data:F,isLoading:q,isFetched:S,error:L}=m(t,v&&w),{query:{view:A}}=(0,i.cq)(),C="all"===x.value,{pageviews:N,visitors:B,visits:M,bounces:P,totaltime:E}=F||{},W=F?[{...N,label:b(y.views),change:N.value-N.prev,formatValue:d.NG},{...M,label:b(y.visits),change:M.value-M.prev,formatValue:d.NG},{...B,label:b(y.visitors),change:B.value-B.prev,formatValue:d.NG},{label:b(y.bounceRate),value:Math.min(M.value,P.value)/M.value*100,prev:Math.min(M.prev,P.prev)/M.prev*100,change:Math.min(M.value,P.value)/M.value*100-Math.min(M.prev,P.prev)/M.prev*100,formatValue:e=>Math.round(+e)+"%",reverseColors:!0},{label:b(y.visitDuration),value:E.value/M.value,prev:E.prev/M.prev,change:E.value/M.value-E.prev/M.prev,formatValue:e=>"".concat(0>+e?"-":"").concat((0,d.nB)(Math.abs(~~e),["m","s"]," "))}]:[],D=[{label:b(y.previousPeriod),value:"prev"},{label:b(y.previousYear),value:"yoy"}];return(0,n.jsxs)("div",{ref:f,className:l()(g().container,{[g().sticky]:r,[g().isSticky]:r&&k}),children:[(0,n.jsx)("div",{children:(0,n.jsx)(u.A,{isLoading:q,isFetched:S,error:L,children:W.map(e=>{let{label:t,value:r,prev:a,change:l,formatValue:i,reverseColors:o}=e;return(0,n.jsx)(c.A,{value:r,previousValue:a,label:t,change:l,formatValue:i,reverseColors:o,showChange:!C&&(v||s),showPrevious:!C&&v},t)})})}),(0,n.jsxs)("div",{className:g().actions,children:[(0,n.jsxs)("div",{children:[p&&(0,n.jsx)(_.A,{websiteId:t}),!A&&(0,n.jsx)(j,{websiteId:t})]}),(0,n.jsx)(o.A,{websiteId:t,showAllTime:!v}),v&&(0,n.jsxs)("div",{className:g().vs,children:[(0,n.jsx)("b",{children:"VS"}),(0,n.jsx)(a.ms,{className:g().dropdown,items:D,value:w||"prev",renderValue:e=>{var t;return null==(t=D.find(t=>t.value===e))?void 0:t.label},alignment:"end",onChange:e=>(0,h.p3)(t,e),children:D.map(e=>{let{label:t,value:r}=e;return(0,n.jsx)(a.q7,{children:t},r)})})]})]})]})}let k=f},72700:(e,t,r)=>{"use strict";r.d(t,{A:()=>o});var n=r(81767),a=r(98780),s=r(93031),l=r(29918),i=r.n(l);function o(e){let{fields:t=[],onSelect:r,showType:l=!0}=e,{formatMessage:o,labels:c}=(0,s.ot)();return(0,n.jsx)(a.lV,{children:(0,n.jsx)(a.fh,{label:o(c.fields),children:(0,n.jsx)(a.W1,{className:i().menu,onSelect:e=>r(t[e]),children:t.map((e,t)=>{let{name:r,label:s,type:o}=e;return(0,n.jsxs)(a.q7,{className:i().item,children:[(0,n.jsx)("div",{children:s||r}),l&&o&&(0,n.jsx)("div",{className:i().type,children:o})]},t)})})})})}},75187:(e,t,r)=>{"use strict";r.d(t,{OM:()=>s,Ou:()=>a,V_:()=>l});var n=r(634);function a(e){if("string"==typeof e){let[,t,r]=e.match(/^(!~|!|~)?(.*)$/);return{operator:Object.keys(n.u$).find(e=>n.u$[e]===t)||n.we.equals,value:r}}return{operator:n.we.equals,value:e}}function s(e){return[n.we.equals,n.we.notEquals].includes(e)}function l(e){return[n.we.contains,n.we.doesNotContain].includes(e)}},86178:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(81767),a=r(13647),s=r(72700),l=r(34266);function i(e){let{websiteId:t,fields:r,startDate:i,endDate:o,onChange:c,allowFilterSelect:u}=e,[d,v]=(0,a.useState)();if(!d)return(0,n.jsx)(s.A,{fields:r,onSelect:v,showType:!1});let{name:p,label:m,type:h}=d;return(0,n.jsx)(l.A,{websiteId:t,name:p,label:m,type:h,startDate:i,endDate:o,onChange:c,allowFilterSelect:u,isNew:!0})}},90397:(e,t,r)=>{"use strict";r.d(t,{A:()=>o});var n=r(81767),a=r(13647),s=r(91160),l=r(93031),i=r(62400);let o=function(e){let{data:t,unit:r,isLoading:o,isAllTime:c,...u}=e,{formatMessage:d,labels:v}=(0,l.ot)(),{colors:p}=(0,l.DP)(),{locale:m}=(0,l.Ym)(),h=(0,a.useMemo)(()=>t?{datasets:[{label:d(v.visitors),data:t.sessions,borderWidth:1,...p.chart.visitors,order:3},{label:d(v.views),data:t.pageviews,borderWidth:1,...p.chart.views,order:4},...t.compare?[{type:"line",label:"".concat(d(v.views)," (").concat(d(v.previous),")"),data:t.compare.pageviews,borderWidth:2,backgroundColor:"#8601B0",borderColor:"#8601B0",order:1},{type:"line",label:"".concat(d(v.visitors)," (").concat(d(v.previous),")"),data:t.compare.sessions,borderWidth:2,backgroundColor:"#f15bb5",borderColor:"#f15bb5",order:2}]:[]]}:{},[t,m]);return(0,n.jsx)(s.A,{...u,data:h,unit:r,isLoading:o,isAllTime:c,renderXLabel:(0,i.C)(r,m)})}},91160:(e,t,r)=>{"use strict";r.d(t,{A:()=>p});var n=r(81767),a=r(93031),s=r(54793),l=r(15962),i=r(98780);let o={millisecond:"T",second:"pp",minute:"p",hour:"p - PP",day:"PPPP",week:"PPPP",month:"LLLL yyyy",quarter:"qqq",year:"yyyy"};function c(e){var t;let{tooltip:r,unit:c,currency:u}=e,{locale:d}=(0,a.Ym)(),{labelColors:v,dataPoints:p}=r;return(0,n.jsxs)(i.LS,{direction:"column",gap:10,children:[(0,n.jsx)("div",{children:(0,s.Yq)(new Date(p[0].raw.d||p[0].raw.x),o[c],d)}),(0,n.jsx)("div",{children:(0,n.jsxs)(i.BG,{color:null==v||null==(t=v[0])?void 0:t.backgroundColor,children:[u?(0,l.Nb)(p[0].raw.y,u):(0,l.NG)(p[0].raw.y)," ",p[0].dataset.label]})})]})}var u=r(85088),d=r(62400),v=r(13647);let p=function(e){let[t,r]=(0,v.useState)(null),{colors:s}=(0,a.DP)(),{renderXLabel:l,renderYLabel:i,unit:o,XAxisType:p="time",YAxisType:m="linear",stacked:h=!1,minDate:_,maxDate:x,currency:b,isAllTime:y}=e,j=(0,v.useMemo)(()=>({scales:{x:{type:p,stacked:!0,min:y?"":_,max:x,time:{unit:o},grid:{display:!1},border:{color:s.chart.line},ticks:{color:s.chart.text,autoSkip:!1,maxRotation:0,callback:l}},y:{type:m,min:0,beginAtZero:!0,stacked:h,grid:{color:s.chart.line},border:{color:s.chart.line},ticks:{color:s.chart.text,callback:i||d.V}}}}),[s,o,h,l,i]);return(0,n.jsx)(u.A,{...e,type:"bar",chartOptions:j,tooltip:t,onTooltip:e=>{let{tooltip:t}=e,{opacity:a}=t;r(a?(0,n.jsx)(c,{tooltip:t,unit:o,currency:b}):null)}})}},91258:(e,t,r)=>{"use strict";r.d(t,{A:()=>o});var n=r(81767),a=r(94118),s=r.n(a),l=r(5968),i=r.n(l);let o=function(e){let{className:t,style:r,children:a}=e;return(0,n.jsx)("div",{className:s()(i().form,t),style:r,onClick:e=>e.stopPropagation(),children:a})}}}]);