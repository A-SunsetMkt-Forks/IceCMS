import{E as S}from"./CQdKq0Vt.js";import{E as z,a as N}from"./Bo10sX-3.js";import{E as k}from"./g0zu4MNc.js";import{v as E}from"./U29o3j68.js";import{u as h}from"./CJdOkxoU.js";import{E as P}from"./B1mjav-x.js";import{E as p}from"./CtkJBwaH.js";import{b as M}from"./3Yncbi-l.js";import{d as L,r as w,I as C,B,k as Z,c as m,o as c,y as F,v as H,a as s,u as o,b as a,g as l,p as I,t as U,e as q,_ as A}from"./C_uFub58.js";import"./BM-sVEEH.js";import"./dXWXmwas.js";import"./BUADUvnR.js";const D={class:"change-password-container home"},R={class:"form-container"},T={class:"form-item-wrapper"},j={class:"form-item-wrapper"},G={class:"password-strength"},J={class:"strength-bar"},K={class:"strength-text"},O={class:"form-item-wrapper"},Q={class:"form-actions"},X={key:0},Y={key:1},$=L({__name:"changePw",setup(ee){const n=w(!1),d=w(),t=w({yuanPassWord:"",NewPassWord:"",ShowPassWord:""}),g=C(()=>{const r=t.value.NewPassWord;if(!r)return"";let e=0;return r.length>=8&&e++,/[a-z]/.test(r)&&e++,/[A-Z]/.test(r)&&e++,/\d/.test(r)&&e++,/[^a-zA-Z\d]/.test(r)&&e++,e<=2?"weak":e<=3?"medium":"strong"}),y=C(()=>{const r=g.value;return t.value.NewPassWord?r==="weak"?"弱":r==="medium"?"中":"强":""}),V=B({yuanPassWord:[{required:!0,message:"请输入原密码",trigger:"blur"}],NewPassWord:[{required:!0,message:"请输入新密码",trigger:"blur"},{min:6,message:"密码长度至少6位",trigger:"blur"}],ShowPassWord:[{required:!0,message:"请确认新密码",trigger:"blur"},{validator:(r,e,i)=>{e!==t.value.NewPassWord?i(new Error("两次输入的密码不一致")):i()},trigger:"blur"}]}),W=async()=>{if(d.value)try{await d.value.validate();const r=h();if(!r.userid){P.error("用户信息无效，请重新登录");return}n.value=!0;const e=await M(t.value.yuanPassWord,t.value.NewPassWord,r.userid);e&&e.code===200?(p({title:"成功",message:"密码修改成功",type:"success",offset:50}),v()):e&&e.code===400?p({title:"失败",message:"原密码不正确，请重新输入",type:"warning",offset:50}):p({title:"失败",message:"密码修改失败",type:"warning",offset:50})}catch(r){console.error("修改密码出错:",r),p({title:"失败",message:"修改失败，请检查网络连接",type:"error",offset:50})}finally{n.value=!1}},v=()=>{d.value&&d.value.resetFields()};return Z(()=>{h().userid||P.warning("请先登录")}),(r,e)=>{const i=S,f=z,_=k,x=N,b=E;return c(),m("div",D,[e[7]||(e[7]=F('<div class="header" data-v-a3a40646><div class="header-icon" data-v-a3a40646><svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-a3a40646><path d="M18 8h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2zM12 17c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2zM15.1 8H8.9V6c0-1.71 1.39-3.1 3.1-3.1 1.71 0 3.1 1.39 3.1 3.1v2z" fill="currentColor" data-v-a3a40646></path></svg></div><h2 data-v-a3a40646>修改密码</h2><p class="subtitle" data-v-a3a40646>为了您的账户安全，请定期更新密码</p></div>',1)),H((c(),m("div",R,[a(x,{ref_key:"formRef",ref:d,model:o(t),rules:o(V),"label-width":"100px",class:"password-form","label-position":"top"},{default:l(()=>[s("div",T,[a(f,{label:"原密码",prop:"yuanPassWord"},{default:l(()=>[a(i,{modelValue:o(t).yuanPassWord,"onUpdate:modelValue":e[0]||(e[0]=u=>o(t).yuanPassWord=u),placeholder:"请输入当前密码","show-password":"",size:"large",class:"password-input"},{prefix:l(()=>e[3]||(e[3]=[s("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[s("path",{d:"M18 8h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2zM12 17c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2zM15.1 8H8.9V6c0-1.71 1.39-3.1 3.1-3.1 1.71 0 3.1 1.39 3.1 3.1v2z",fill:"currentColor"})],-1)])),_:1},8,["modelValue"])]),_:1})]),s("div",j,[a(f,{label:"新密码",prop:"NewPassWord"},{default:l(()=>[a(i,{modelValue:o(t).NewPassWord,"onUpdate:modelValue":e[1]||(e[1]=u=>o(t).NewPassWord=u),placeholder:"请输入新密码（至少6位）","show-password":"",size:"large",class:"password-input"},{prefix:l(()=>e[4]||(e[4]=[s("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[s("path",{d:"M12 2C13.1 2 14 2.9 14 4C14 5.1 13.1 6 12 6C10.9 6 10 5.1 10 4C10 2.9 10.9 2 12 2ZM21 9V7L15 1L13.5 2.5L16.17 5.17C15.24 5.06 14.32 5 13.38 5C10.38 5 7.68 6.64 6.09 9.22L7.66 10.79C8.78 8.61 10.79 7 13.38 7C14.32 7 15.24 7.17 16.17 7.5L13.5 10.17L15 11.67L21 9Z",fill:"currentColor"})],-1)])),_:1},8,["modelValue"]),s("div",G,[s("div",J,[s("div",{class:I(["strength-fill",o(g)])},null,2)]),s("span",K,U(o(y)),1)])]),_:1})]),s("div",O,[a(f,{label:"确认新密码",prop:"ShowPassWord"},{default:l(()=>[a(i,{modelValue:o(t).ShowPassWord,"onUpdate:modelValue":e[2]||(e[2]=u=>o(t).ShowPassWord=u),placeholder:"请再次输入新密码","show-password":"",size:"large",class:"password-input"},{prefix:l(()=>e[5]||(e[5]=[s("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[s("path",{d:"M9 12L11 14L15 10M21 12C21 16.97 16.97 21 12 21C7.03 21 3 16.97 3 12C3 7.03 7.03 3 12 3C16.97 3 21 7.03 21 12Z",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)])),_:1},8,["modelValue"])]),_:1})]),s("div",Q,[a(_,{type:"primary",onClick:W,loading:o(n),size:"large",class:"submit-btn"},{default:l(()=>[o(n)?(c(),m("span",Y,"更新中...")):(c(),m("span",X,"更新密码"))]),_:1},8,["loading"]),a(_,{onClick:v,size:"large",class:"reset-btn"},{default:l(()=>e[6]||(e[6]=[q(" 重置表单 ")])),_:1})])]),_:1},8,["model","rules"])])),[[b,o(n)]]),e[8]||(e[8]=s("div",{class:"security-tips"},[s("h3",null,"密码安全建议"),s("ul",null,[s("li",null,"密码长度至少8位，建议包含大小写字母、数字和特殊字符"),s("li",null,"不要使用过于简单的密码，如生日、手机号等"),s("li",null,"定期更换密码，建议每3-6个月更换一次"),s("li",null,"不要在多个平台使用相同密码")])],-1))])}}}),ce=A($,[["__scopeId","data-v-a3a40646"]]);export{ce as default};
