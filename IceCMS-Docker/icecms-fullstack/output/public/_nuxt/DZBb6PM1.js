import{E as X}from"./CQdKq0Vt.js";import{a as Y}from"./Bo10sX-3.js";import{E as G}from"./g0zu4MNc.js";import{E as K}from"./yw5b7RCA.js";import{E as D}from"./CtkJBwaH.js";import{a as Q,w as W}from"./D38A-MsW.js";import{i as ee,h as te}from"./DFZ1BoYC.js";import{a9 as oe,r as g,aa as q,D as Z,ab as z,ac as ie,a6 as ae,_ as se,I as ne,ad as le,l as re,c as B,o as P,y as de,a as e,b as C,p as V,u as p,g as x,q as ce,t as S,e as ue,a5 as j}from"./C_uFub58.js";import"./BM-sVEEH.js";import"./dXWXmwas.js";import"./CXVv3ulD.js";import"./BUADUvnR.js";import"./CRxF1tn9.js";function fe(t,s){if(typeof t!="string")throw new TypeError("argument str must be a string");const i={},a=s||{},d=a.decode||pe;let r=0;for(;r<t.length;){const n=t.indexOf("=",r);if(n===-1)break;let c=t.indexOf(";",r);if(c===-1)c=t.length;else if(c<n){r=t.lastIndexOf(";",n-1)+1;continue}const u=t.slice(r,n).trim();if(a?.filter&&!a?.filter(u)){r=c+1;continue}if(i[u]===void 0){let v=t.slice(n+1,c).trim();v.codePointAt(0)===34&&(v=v.slice(1,-1)),i[u]=ve(v,d)}r=c+1}return i}function pe(t){return t.includes("%")?decodeURIComponent(t):t}function ve(t,s){try{return s(t)}catch{return t}}const I=/^[\u0009\u0020-\u007E\u0080-\u00FF]+$/;function O(t,s,i){const a=i||{},d=a.encode||encodeURIComponent;if(typeof d!="function")throw new TypeError("option encode is invalid");if(!I.test(t))throw new TypeError("argument name is invalid");const r=d(s);if(r&&!I.test(r))throw new TypeError("argument val is invalid");let n=t+"="+r;if(a.maxAge!==void 0&&a.maxAge!==null){const c=a.maxAge-0;if(Number.isNaN(c)||!Number.isFinite(c))throw new TypeError("option maxAge is invalid");n+="; Max-Age="+Math.floor(c)}if(a.domain){if(!I.test(a.domain))throw new TypeError("option domain is invalid");n+="; Domain="+a.domain}if(a.path){if(!I.test(a.path))throw new TypeError("option path is invalid");n+="; Path="+a.path}if(a.expires){if(!me(a.expires)||Number.isNaN(a.expires.valueOf()))throw new TypeError("option expires is invalid");n+="; Expires="+a.expires.toUTCString()}if(a.httpOnly&&(n+="; HttpOnly"),a.secure&&(n+="; Secure"),a.priority)switch(typeof a.priority=="string"?a.priority.toLowerCase():a.priority){case"low":{n+="; Priority=Low";break}case"medium":{n+="; Priority=Medium";break}case"high":{n+="; Priority=High";break}default:throw new TypeError("option priority is invalid")}if(a.sameSite)switch(typeof a.sameSite=="string"?a.sameSite.toLowerCase():a.sameSite){case!0:{n+="; SameSite=Strict";break}case"lax":{n+="; SameSite=Lax";break}case"strict":{n+="; SameSite=Strict";break}case"none":{n+="; SameSite=None";break}default:throw new TypeError("option sameSite is invalid")}return a.partitioned&&(n+="; Partitioned"),n}function me(t){return Object.prototype.toString.call(t)==="[object Date]"||t instanceof Date}function h(t){if(typeof t!="object")return t;var s,i,a=Object.prototype.toString.call(t);if(a==="[object Object]"){if(t.constructor!==Object&&typeof t.constructor=="function"){i=new t.constructor;for(s in t)t.hasOwnProperty(s)&&i[s]!==t[s]&&(i[s]=h(t[s]))}else{i={};for(s in t)s==="__proto__"?Object.defineProperty(i,s,{value:h(t[s]),configurable:!0,enumerable:!0,writable:!0}):i[s]=h(t[s])}return i}if(a==="[object Array]"){for(s=t.length,i=Array(s);s--;)i[s]=h(t[s]);return i}return a==="[object Set]"?(i=new Set,t.forEach(function(d){i.add(h(d))}),i):a==="[object Map]"?(i=new Map,t.forEach(function(d,r){i.set(h(r),h(d))}),i):a==="[object Date]"?new Date(+t):a==="[object RegExp]"?(i=new RegExp(t.source,t.flags),i.lastIndex=t.lastIndex,i):a==="[object DataView]"?new t.constructor(h(t.buffer)):a==="[object ArrayBuffer]"?t.slice(0):a.slice(-6)==="Array]"?new t.constructor(t):t}const ge={path:"/",watch:!0,decode:t=>oe(decodeURIComponent(t)),encode:t=>encodeURIComponent(typeof t=="string"?t:JSON.stringify(t))},T=window.cookieStore;function U(t,s){const i={...ge,...s};i.filter??=v=>v===t;const a=R(i)||{};let d;i.maxAge!==void 0?d=i.maxAge*1e3:i.expires&&(d=i.expires.getTime()-Date.now());const r=d!==void 0&&d<=0,n=r||a[t]===void 0||a[t]===null,c=h(r?void 0:a[t]??i.default?.()),u=d&&!r?ye(c,d,i.watch&&i.watch!=="shallow"):g(c);{let v=null;try{!T&&typeof BroadcastChannel<"u"&&(v=new BroadcastChannel(`nuxt:cookies:${t}`))}catch{}const l=(w=!1)=>{!w&&(i.readonly||ee(u.value,a[t]))||(he(t,u.value,i),a[t]=h(u.value),v?.postMessage({value:i.encode(u.value)}))},y=w=>{const b=w.refresh?R(i)?.[t]:i.decode(w.value);E=!0,u.value=b,a[t]=h(b),ae(()=>{E=!1})};let E=!1;const k=!!z();if(k&&q(()=>{E=!0,l(),v?.close()}),T){const w=b=>{const _=b.changed.find(f=>f.name===t),M=b.deleted.find(f=>f.name===t);_&&y({value:_.value}),M&&y({value:null})};T.addEventListener("change",w),k&&q(()=>T.removeEventListener("change",w))}else v&&(v.onmessage=({data:w})=>y(w));i.watch&&Z(u,()=>{E||l()},{deep:i.watch!=="shallow"}),n&&l(n)}return u}function R(t={}){return fe(document.cookie,t)}function we(t,s,i={}){return s==null?O(t,s,{...i,maxAge:-1}):O(t,s,i)}function he(t,s,i={}){document.cookie=we(t,s,i)}const $=2147483647;function ye(t,s,i){let a,d,r=0;const n=i?g(t):{value:t};return z()&&q(()=>{d?.(),clearTimeout(a)}),ie((c,u)=>{i&&(d=Z(n,u));function v(){r=0,clearTimeout(a);const l=s-r,y=l<$?l:$;a=setTimeout(()=>{if(r+=y,r<s)return v();n.value=void 0,u()},y)}return{get(){return c(),n.value},set(l){v(),n.value=l,u()}}})}const be=(t,s,i)=>te.get(`/User/UpdateIntegral/${t}/${s}/${i}`),F=window.setInterval,Le={class:"charge-container home"},Ce={class:"quick-charge-section"},ke={class:"charge-options"},xe={class:"custom-charge-section"},Ee={class:"custom-input-container"},Se={class:"input-wrapper"},_e={class:"input-group"},Ve={key:0,class:"charge-info"},Ie={class:"info-item"},Te={class:"value"},Me={class:"info-item"},Ae={class:"value price-highlight"},De={class:"charge-actions"},je={class:"payment-methods"},Ue={class:"qr-content"},qe={class:"qr-header"},Ne={class:"payment-info"},Be={class:"amount"},Pe={class:"desc"},Oe={class:"qr-code"},Re={class:"qr-content"},$e={class:"qr-header"},Fe={class:"payment-info"},Ze={class:"amount"},ze={class:"desc"},He={class:"qr-code"},Je={__name:"charge",setup(t){const s=g(0);g(!0);const i=g(!1),a=g(""),d=g("url"),r=g(!1),n=g(!1),c=g(!1),u=g(null),v=g({productId:"",payType:"wxpay"}),l=g({integral:""}),y=f=>!f||f<=0?"0.00":(f*.1).toFixed(2),E=ne(()=>l.value.integral&&l.value.integral>0),k=f=>{s.value=f,l.value.integral=f.toString()},w=()=>{const f=U("access-user");console.log("查询订单状态"),be(f.value?.data?.userid,l.value.integral,a.value).then(o=>{console.log(o),o.data.code==402||o.data.code==400||o.data.code==200&&(console.log("清除定时器"),clearInterval(u.value),n.value=!1,c.value=!1,D({title:"支付成功",message:"积分充值成功！",type:"success",offset:50}),l.value.integral="",s.value=0)})},b=()=>{console.log("关闭对话框"),i.value=!1,u.value&&(console.log("清除定时器"),clearInterval(u.value))},_=f=>{console.log("支付方式："+f),v.value.payType=f,r.value=!1;const o=U("access-user");f==="alipay"?(c.value=!0,Q.ftofPayVipIntegralLogin(l.value.integral,o.value?.data?.userid).then(L=>{console.log(L.data.data.codeUrl),d.value=L.data.data.codeUrl,a.value=L.data.data.orderNo,u.value=F(()=>{w()},3e3)})):f==="wxpay"&&(n.value=!0,W.nativePayVipIntegralLogin(l.value.integral,o.value?.data?.userid).then(L=>{console.log(L.data.data.codeUrl),d.value=L.data.data.codeUrl,a.value=L.data.data.orderNo,u.value=F(()=>{w()},3e3)}))},M=()=>{const f=U("access-user");if(!f.value||!f.value.data){D({title:"失败",message:"暂未登录，请登录后重试",type:"warning",offset:50});return}if(!l.value.integral||l.value.integral<=0){D({title:"提示",message:"请输入有效的积分数量",type:"warning",offset:50});return}i.value=!0,r.value=!0};return le(()=>{u.value&&clearInterval(u.value)}),(f,o)=>{const L=X,H=Y,J=G,A=K,N=re("qriously");return P(),B("div",Le,[o[28]||(o[28]=de('<div class="page-header" data-v-b9f3a935><div class="header-icon" data-v-b9f3a935><svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-b9f3a935><path d="M12 2L13.09 8.26L22 9L13.09 9.74L12 16L10.91 9.74L2 9L10.91 8.26L12 2Z" fill="currentColor" data-v-b9f3a935></path><path d="M19 15L20.09 18.26L24 19L20.09 19.74L19 23L17.91 19.74L14 19L17.91 18.26L19 15Z" fill="currentColor" data-v-b9f3a935></path><path d="M5 15L6.09 18.26L10 19L6.09 19.74L5 23L3.91 19.74L0 19L3.91 18.26L5 15Z" fill="currentColor" data-v-b9f3a935></path></svg></div><h2 data-v-b9f3a935>积分充值</h2><p class="subtitle" data-v-b9f3a935>充值积分，解锁更多优质内容</p></div>',1)),e("div",Ce,[o[14]||(o[14]=e("h3",null,"快速充值",-1)),e("div",ke,[e("div",{class:V(["charge-option",{active:p(s)===100}]),onClick:o[0]||(o[0]=m=>k(100))},o[10]||(o[10]=[e("div",{class:"amount"},"100",-1),e("div",{class:"unit"},"积分",-1),e("div",{class:"price"},"¥10",-1),e("div",{class:"badge popular"},"热门",-1)]),2),e("div",{class:V(["charge-option",{active:p(s)===500}]),onClick:o[1]||(o[1]=m=>k(500))},o[11]||(o[11]=[e("div",{class:"amount"},"500",-1),e("div",{class:"unit"},"积分",-1),e("div",{class:"price"},"¥45",-1),e("div",{class:"badge discount"},"9折",-1)]),2),e("div",{class:V(["charge-option",{active:p(s)===1e3}]),onClick:o[2]||(o[2]=m=>k(1e3))},o[12]||(o[12]=[e("div",{class:"amount"},"1000",-1),e("div",{class:"unit"},"积分",-1),e("div",{class:"price"},"¥80",-1),e("div",{class:"badge discount"},"8折",-1)]),2),e("div",{class:V(["charge-option",{active:p(s)===2e3}]),onClick:o[3]||(o[3]=m=>k(2e3))},o[13]||(o[13]=[e("div",{class:"amount"},"2000",-1),e("div",{class:"unit"},"积分",-1),e("div",{class:"price"},"¥140",-1),e("div",{class:"badge vip"},"VIP",-1)]),2)])]),e("div",xe,[o[20]||(o[20]=e("h3",null,"自定义充值",-1)),e("div",Ee,[C(H,{ref_key:"form",ref:l,model:p(l),"label-width":"0"},{default:x(()=>[e("div",Se,[o[19]||(o[19]=e("div",{class:"input-label"},"充值积分数量",-1)),e("div",_e,[C(L,{modelValue:p(l).integral,"onUpdate:modelValue":o[4]||(o[4]=m=>p(l).integral=m),placeholder:"请输入积分数量",type:"number",size:"large",class:"integral-input",min:1,max:1e4},{prefix:x(()=>o[15]||(o[15]=[e("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[e("path",{d:"M12 2L13.09 8.26L22 9L13.09 9.74L12 16L10.91 9.74L2 9L10.91 8.26L12 2Z",fill:"currentColor"})],-1)])),suffix:x(()=>o[16]||(o[16]=[e("span",{class:"input-suffix"},"积分",-1)])),_:1},8,["modelValue"])]),p(l).integral&&p(l).integral>0?(P(),B("div",Ve,[e("div",Ie,[o[17]||(o[17]=e("span",{class:"label"},"充值积分：",-1)),e("span",Te,S(p(l).integral)+" 积分",1)]),e("div",Me,[o[18]||(o[18]=e("span",{class:"label"},"需要支付：",-1)),e("span",Ae,"¥"+S(y(p(l).integral)),1)])])):ce("",!0)])]),_:1},8,["model"])])]),e("div",De,[C(J,{type:"primary",onClick:M,disabled:!p(E),size:"large",class:"charge-btn"},{default:x(()=>o[21]||(o[21]=[e("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[e("path",{d:"M12 2L13.09 8.26L22 9L13.09 9.74L12 16L10.91 9.74L2 9L10.91 8.26L12 2Z",fill:"currentColor"})],-1),ue(" 立即充值 ")])),_:1},8,["disabled"])]),o[29]||(o[29]=e("div",{class:"charge-notice"},[e("h4",null,"充值说明"),e("ul",null,[e("li",null,"充值的积分可用于购买付费内容、下载资源等"),e("li",null,"积分一经充值不可退换，请谨慎操作"),e("li",null,"支持微信支付、支付宝等多种支付方式"),e("li",null,"充值过程中如遇问题，请联系客服")])],-1)),C(A,{modelValue:p(r),"onUpdate:modelValue":o[7]||(o[7]=m=>j(r)?r.value=m:null),title:"选择支付方式",width:"400px","before-close":b,class:"payment-dialog"},{default:x(()=>[e("div",je,[e("div",{class:"payment-method",onClick:o[5]||(o[5]=m=>_("alipay"))},o[22]||(o[22]=[e("div",{class:"method-icon alipay"},[e("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[e("path",{d:"M12 2C17.5 2 22 6.5 22 12C22 17.5 17.5 22 12 22C6.5 22 2 17.5 2 12C2 6.5 6.5 2 12 2Z",fill:"#1677FF"}),e("path",{d:"M12 6V18M6 12H18",stroke:"white","stroke-width":"2","stroke-linecap":"round"})])],-1),e("div",{class:"method-info"},[e("div",{class:"method-name"},"支付宝"),e("div",{class:"method-desc"},"推荐使用")],-1),e("div",{class:"method-arrow"},[e("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[e("path",{d:"M9 18L15 12L9 6",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})])],-1)])),e("div",{class:"payment-method",onClick:o[6]||(o[6]=m=>_("wxpay"))},o[23]||(o[23]=[e("div",{class:"method-icon wechat"},[e("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[e("path",{d:"M12 2C17.5 2 22 6.5 22 12C22 17.5 17.5 22 12 22C6.5 22 2 17.5 2 12C2 6.5 6.5 2 12 2Z",fill:"#09bb21"}),e("path",{d:"M8 14L12 10L16 14",stroke:"white","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})])],-1),e("div",{class:"method-info"},[e("div",{class:"method-name"},"微信支付"),e("div",{class:"method-desc"},"安全便捷")],-1),e("div",{class:"method-arrow"},[e("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[e("path",{d:"M9 18L15 12L9 6",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})])],-1)]))])]),_:1},8,["modelValue"]),C(A,{modelValue:p(n),"onUpdate:modelValue":o[8]||(o[8]=m=>j(n)?n.value=m:null),title:"微信支付",width:"360px","before-close":b,class:"qr-dialog"},{default:x(()=>[e("div",Ue,[e("div",qe,[o[24]||(o[24]=e("div",{class:"payment-logo wechat-logo"},[e("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[e("path",{d:"M12 2C17.5 2 22 6.5 22 12C22 17.5 17.5 22 12 22C6.5 22 2 17.5 2 12C2 6.5 6.5 2 12 2Z",fill:"#09bb21"})])],-1)),e("div",Ne,[e("div",Be,"¥"+S(y(p(l).integral)),1),e("div",Pe,S(p(l).integral)+" 积分",1)])]),e("div",Oe,[C(N,{value:p(d),size:200},null,8,["value"])]),o[25]||(o[25]=e("div",{class:"qr-footer"},[e("p",null,"请使用微信扫一扫"),e("p",null,"扫描二维码完成支付")],-1))])]),_:1},8,["modelValue"]),C(A,{modelValue:p(c),"onUpdate:modelValue":o[9]||(o[9]=m=>j(c)?c.value=m:null),title:"支付宝支付",width:"360px","before-close":b,class:"qr-dialog"},{default:x(()=>[e("div",Re,[e("div",$e,[o[26]||(o[26]=e("div",{class:"payment-logo alipay-logo"},[e("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[e("path",{d:"M12 2C17.5 2 22 6.5 22 12C22 17.5 17.5 22 12 22C6.5 22 2 17.5 2 12C2 6.5 6.5 2 12 2Z",fill:"#1677FF"})])],-1)),e("div",Fe,[e("div",Ze,"¥"+S(y(p(l).integral)),1),e("div",ze,S(p(l).integral)+" 积分",1)])]),e("div",He,[C(N,{value:p(d),size:200},null,8,["value"])]),o[27]||(o[27]=e("div",{class:"qr-footer"},[e("p",null,"请使用支付宝扫一扫"),e("p",null,"扫描二维码完成支付")],-1))])]),_:1},8,["modelValue"])])}}},lt=se(Je,[["__scopeId","data-v-b9f3a935"]]);export{lt as default};
